<?xml version="1.0"?>

<!-- 
  If Apache Ant is installed, the framework can be tested using the command
      ant -f test.xml
      
  See <http://ant.apache.org/> for instructions on installing Apache Ant.
-->
 
<project name="MOEA Framework Testing" basedir="." default="test">

	<property environment="env" />
	
	<path id="classpath">
		<fileset dir="lib" includes="*.jar" />
	</path>

	<target name="test">
		<mkdir dir="test-results" />
		<mkdir dir="test-results/raw" />
	
		<junit printsummary="on" haltonfailure="false" 
				tempdir="test-results/raw" errorproperty="junit.failure"
				failureproperty="junit.failure">
			<classpath refid="classpath" />
			<batchtest todir="test-results/raw">
				<formatter type="xml" />
				<zipfileset src="lib/${shortname}-${version}-test.jar">
					<include name="**/*Test.class" />
					<exclude name="org/moeaframework/algorithm/AlgorithmTest.class" />
					<exclude name="org/moeaframework/core/indicator/IndicatorTest.class" />
					<exclude name="org/moeaframework/analysis/collector/CollectorTest.class" />
					<exclude name="org/moeaframework/core/operator/DistributionVariationTest.class" />
					<exclude name="org/moeaframework/core/operator/MeanCentricVariationTest.class" />
					<exclude name="org/moeaframework/core/operator/ParentCentricVariationTest.class" />
					<exclude name="org/moeaframework/core/operator/ParentImmutabilityTest.class" />
					<exclude name="org/moeaframework/core/operator/PointCrossoverTest.class" />
					<exclude name="org/moeaframework/core/operator/TypeSafetyTest.class" />
					<exclude name="org/moeaframework/problem/ProblemTest.class" />
					<exclude name="org/moeaframework/util/sequence/SequenceTest.class" />
					<exclude name="org/moeaframework/util/statistics/IntervalRatioStatisticalTest.class" />
					<exclude name="org/moeaframework/util/statistics/KruskalWallisTest.class" />
					<exclude name="org/moeaframework/util/statistics/MannWhitneyUTest.class" />
					<exclude name="org/moeaframework/util/statistics/OrdinalStatisticalTest.class" />
					<exclude name="org/moeaframework/util/statistics/SingleSampleTTest.class" />
					<exclude name="org/moeaframework/util/statistics/StatisticalTest.class" />
					<exclude name="org/moeaframework/util/statistics/TwoSampleTTest.class" />
					<exclude name="org/moeaframework/util/statistics/WilcoxonSignedRanksTest.class" />
				</zipfileset>
			</batchtest>
		</junit>

		<junitreport todir="test-results">
			<fileset dir="test-results/raw">
				<include name="TEST-*.xml"/>
			</fileset>
			<report format="frames" todir="test-results"/>
		</junitreport>
		
		<fail if="junit.failure" message="Unit test(s) failed.  See reports!"/>
	</target>
	
</project>