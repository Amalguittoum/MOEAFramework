<?xml version="1.0"?>
<project name="MOEA Framework Testing" basedir="." default="test">

	<property file="build.properties" />
	<property environment="env" />
	
	<path id="classpath">
		<fileset dir="lib" includes="*.jar" />
	</path>

	<target name="test">
		<mkdir dir="test-results" />
		<mkdir dir="test-results/raw" />
	
		<junit printsummary="on" haltonfailure="false" 
				tempdir="test-results/raw" errorproperty="junit.failure"
				failureproperty="junit.failure">
			<classpath refid="classpath" />
			<batchtest todir="test-results/raw">
				<formatter type="xml" />
				<zipfileset src="lib/${shortname}-${version}-test.jar">
					<include name="**/*Test.class" />
					<exclude name="**/DistributionVariationTest.class" />
					<exclude name="**/MeanCentricVariationTest.class" />
					<exclude name="**/ParentCentricVariationTest.class" />
					<exclude name="**/ParentImmutabilityTest.class" />
					<exclude name="**/IndicatorTest.class" />
					<exclude name="**/PointCrossoverTest.class" />
					<exclude name="**/TypeSafetyTest.class" />
					<exclude name="**/ProblemTest.class" />
					<exclude name="**/SequenceTest.class" />
					<exclude name="**/IntervalRatioStatisticalTest.class" />
					<exclude name="**/KruskalWallisTest.class" />
					<exclude name="**/MannWhitneyUTest.class" />
					<exclude name="**/OrdinalStatisticalTest.class" />
					<exclude name="**/SingleSampleTTest.class" />
					<exclude name="**/StatisticalTest.class" />
					<exclude name="**/TwoSampleTTest.class" />
					<exclude name="**/WilcoxonSignedRanksTest.class" />
				</zipfileset>
			</batchtest>
		</junit>

		<junitreport todir="test-results">
			<fileset dir="test-results/raw">
				<include name="TEST-*.xml"/>
			</fileset>
			<report format="frames" todir="test-results"/>
		</junitreport>
		
		<fail if="junit.failure" message="Unit test(s) failed.  See reports!"/>
	</target>
	
</project>